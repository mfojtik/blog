<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> How to run Hugo on OpenShift v3 &middot; mfojtik blog </title>


<link rel="stylesheet" href="http://mfojtik.io/css/slim.css">
<link rel="stylesheet" href="http://mfojtik.io/css/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="http://mfojtik.io">mfojtik blog</a></h1>
  <p class="site-tagline"><em>Look at you, hacker. A pathetic creature of meat and bone, panting and sweating as you run through my corridors. How can you challenge perfect immortal machine</em></p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
       
	  <li class="spacer">&ac;</li>

      <li><a href="https://github.com/mfojtik">Github</a></li> 
      <li><a href="https://twitter.com/mfojtik">Twitter</a></li> 
    </ul>
  </div>
</div>

    <div class="content">
      <div class="posts">
        <div class="post">
          <h2 class="post-title"><a href="http://mfojtik.io/post/running-hugo-in-openshift/">How to run Hugo on OpenShift v3</a></h2>
          <span class="post-date">Feb 18, 2016 </span>
          <div class="post-content">
            <p>In my <a href="http://mfojtik.im/post/openshift-v3-digitalocean/">previous</a> post I
described how I transitioned myself into the <em>container era</em> by installing the
OpenShift v3 in <a href="http://digitalocean.com">DigitalOcean</a> and containerizing my
applications. This post will describe how I moved from my previous blog engine
to <a href="http://gohugo.io/">Hugo</a> engine.</p>

<p>My previous blog engine was a hand-written <a href="http://sinatrarb.com">Sinatra</a>
application that was just serving Markdown files. Everything else was just
Javascript. While that seems pretty decent and minimal, in fact it is not. The
<a href="https://github.com/openshift/sti-ruby">Ruby</a> Docker image is something around
430MB and while 90% of that is just <code>centos:7</code>, it is still &lsquo;too much&rsquo;. Also the
ruby itself is pretty memory hungry and DigitalOcean is not really about having
extra memory to spare.</p>

<p>I was looking into something more minimal, preferably <a href="https://golang.org/">Go</a>
based static web site generator, so I can just copy the static binary into a
minimal Docker image and have really small image with my blog in the end.</p>

<p>Then I found <a href="http://gohugo.io/">hugo</a>. It is fast and flexible static site
generator, written by <a href="http://spf13.com/">spf13</a>, a guy who is behind popular
<a href="https://github.com/spf13/cobra">cobra</a> and many other successfull Go projects.</p>

<p>Hugo is <strong>very</strong> simple to use tool, you can check the
<a href="http://gohugo.io/overview/quickstart/">tutorial</a>, and what it basically does is
converting the Markdown files into static HTML pages. It also comes with
countless themes you can start from.  As a bonus, it also comes with very fast
HTTP server, which is built-in into its binary.</p>

<p>Now, how to configure OpenShift to automatically build and deploy my blog?
First, I have to create <a href="https://github.com/mfojtik/hugo-blog">Github
repository</a> and upload my content there.</p>

<p>Then I need to craft the
<a href="https://github.com/openshift/source-to-image">Source-To-Image</a> builder image
that will take the source (content above) and produce the Docker image that will
contain hugo server and my content.</p>

<p>The source for the image is <a href="https://github.com/mfojtik/sti-hugo">here</a>.
Some points about this image:</p>

<ul>
<li>It uses <code>FROM golang:alpine</code> which is a new official <a href="https://hub.docker.com/_/golang/">Go builder image</a> based on minimal Alpine Linux.</li>
<li>It compiles hugo from the source, giving me the latest master version.</li>
<li>I remove all unnecesary packages after the build to keep the final image small.</li>
<li>Image log to a pipe which is streamed to the standard output, so I can watch the logs in container log.</li>
<li>The <code>assemble</code> script compiles the blog content to verify that nothing is broken.</li>
<li>You can change the theme by setting <code>HUGO_THEME</code> variable.</li>
<li>And you should change <code>HUGO_BASE_URL</code> as well ;-)</li>
</ul>

<p>To create my blog, I run the following command:</p>

<pre><code>$ oc new-app mfojtik/hugo~https://github.com/mfojtik/hugo-blog
</code></pre>

<p>That&rsquo;s it! The resulting image is ~200 MB. It also consume almost no memory, so
I can scale it up on DigitalOcean without adding extra node to get more memory.</p>

<p>I also configured the Github hooks to automatically trigger the build of this
blog when I push to the <code>master</code> branch. Which is how I publishing this article.
Jut by pushing it to github. And you can see the result here :-)</p>

          </div>
        </div>
        <div class="pagination">
          <a class="btn previous " href="http://mfojtik.io/post/file-sharing-on-openshift/"> Prev</a>  
          <a class="btn next " href="http://mfojtik.io/post/openshift-v3-digitalocean/"> Next</a> 
        </div>
      </div>
    </div>
    
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = "http://mfojtik.io/post/running-hugo-in-openshift/";
        
      };
      (function() {
        var d = document, s = d.createElement('script');
        s.src = '//mfojtik.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
    <div class="footer">
  <p>Powered by <a href="http://gohugo.io">hugo</a> and the <a
    href="https://github.com/zhe/hugo-theme-slim">slim</a> theme.</p>
</div>

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-109743259-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109743259-2');
</script>

  </div>
  <script src="http://mfojtik.io/js/slim.js"></script>
  <script src="http://mfojtik.io/js/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
</body>

</html>
